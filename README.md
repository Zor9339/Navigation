# Интерактивная система навигации

## Обзор
Приложение позволяет создавать карты для навигации группы лиц по определенной территории. Эта система полезна для организации работы различных комплексов, кампусов, предоставляя интерактивный интерфейс для визуализации карты и поиска путей.

Проект демонстрирует алгоритмы и структуры данных, основанные на графах, которые широко используются в компаниях для таких задач, как системы навигации, логистика и управление инфраструктурой. Он показывает, как теория графов применяется для решения реальных задач.

## Задача
Задача заключается в создании системы, которая:
1. Позволяет пользователям создавать карту, добавляя здания (вершины графа), дороги и перекрестки (ребра и промежуточные вершины).
2. Обеспечивает возможность редактирования карты (добавление, удаление, изменение элементов).
3. Находит кратчайший путь между двумя зданиями с учетом весов ребер (длина дорог).
4. Визуализирует карту и найденные пути в удобном графическом интерфейсе.

Эта задача актуальна в предприятиях, имеющих большие комплексы зданий. Например, в университетских кампусах абитуриенты и иностранные студенты часто не могут найти нужный корпус.

## Назначение и преимущества подхода
### Зачем нужен выбранный алгоритм (Дейкстры)?
Алгоритм Дейкстры используется для поиска кратчайшего пути в невзвешенном или взвешенном графе с неотрицательными весами. В данном проекте он применяется для нахождения оптимального маршрута между зданиями, где веса ребер представляют длину дорог. Преимущества алгоритма:
- **Гарантия оптимальности**: Находит кратчайший путь, если он существует.
- **Эффективность**: Для разреженных графов (как в случае кампусов) с использованием приоритетной очереди время выполнения составляет O((V + E) log V), где V — число вершин, E — число ребер.
- **Простота реализации**: Легко интегрируется в объектно-ориентированный проект.

### Чем полезен предложенный подход?
- **Интерактивность**: Пользователи могут визуально добавлять и редактировать элементы карты, что упрощает создание и тестирование.
- **Гибкость**: Поддержка различных форм зданий (прямоугольники, окружности) и динамическое добавление перекрестков.
- **Масштабируемость**: Графовая модель позволяет легко расширять функциональность, например, добавлять веса на основе времени или доступности.
- **Реалистичность**: Визуализация дорог, зданий и путей.
- **Сохранение данных**: Карты можно сохранять и загружать в формате `.map`, что обеспечивает переносимость.

## Архитектура проекта
Проект разделен на три основных пакета: `model`, `ui` и `util`. Каждый компонент имеет четкое назначение, что соответствует принципам модульности и разделения ответственности.

### Компоненты
1. **Пакет `model`**:
    - **`CampusMap.java`**: Основной класс, представляющий карту кампуса как граф. Хранит вершины (здания и перекрестки), ребра (дороги) и реализует алгоритм Дейкстры для поиска кратчайшего пути.
        - **Входные параметры**:
            - Для добавления здания: имя, полигон формы, точка входа.
            - Для добавления дороги: идентификаторы начальной и конечной вершин.
            - Для поиска пути: идентификаторы начального и конечного здания.
        - **Выходные параметры**:
            - Список идентификаторов вершин, представляющих кратчайший путь.
            - Коллекции вершин и ребер графа.
        - **Методы**:
            - `addBuilding`: Добавляет здание с указанной формой и точкой входа.
            - `addJunction`: Добавляет перекресток в указанной позиции.
            - `addRoad`: Создает дорогу между двумя вершинами.
            - `deleteNode`, `deleteEdge`: Удаляет вершину или ребро.
            - `findShortestPath`: Реализует алгоритм Дейкстры для поиска кратчайшего пути.
    - **Внутренние классы**:
        - `Node`: Представляет вершину (здание или перекресток) с идентификатором, позицией, формой и точкой входа.
        - `Edge`: Представляет ребро (дорогу) с начальной и конечной вершинами, длиной и весом.

2. **Пакет `ui`**:
    - **`MapPanel.java`**: Компонент для визуализации карты. Отображает здания, дороги, перекрестки и пути, поддерживает взаимодействие с пользователем (рисование, редактирование, масштабирование).
        - **Входные параметры**:
            - Объект `CampusMap` для доступа к данным графа.
            - События мыши для взаимодействия (клики, перетаскивание).
        - **Выходные параметры**:
            - Визуальное представление карты.
            - Объект, выбранный пользователем (вершина или ребро).
        - **Функции**:
            - Отрисовка зданий (полупрозрачные полигоны), дорог (серые линии), путей (синие линии).
            - Поддержка масштабирования и перемещения карты.
            - Режимы добавления зданий (прямоугольник/окружность), дорог и редактирования.
    - **`Navigation.java`**: Основной класс пользовательского интерфейса. Управляет режимами (редактирование/навигация), предоставляет кнопки и выпадающие списки для взаимодействия.
        - **Входные параметры**:
            - Флаг `navigationOnly` для ограничения функциональности (только навигация).
            - Путь к директории карт.
        - **Выходные параметры**:
            - Графический интерфейс с элементами управления.
        - **Функции**:
            - Переключение между режимами редактирования и навигации.
            - Управление добавлением, сохранением, загрузкой карт.
            - Выбор начального и конечного здания для поиска пути.

3. **Пакет `util`**:
    - **`FileUtil.java`**: Утилита для работы с файлами (сохранение/загрузка карт, обновление списка карт).
        - **Входные параметры**:
            - Путь к директории карт.
        - **Выходные параметры**:
            - Список доступных карт для загрузки.
        - **Функции**:
            - Сохранение карты в файл `.map` с помощью сериализации.
            - Загрузка карты из файла.
            - Обновление выпадающего списка карт.

### Алгоритмы
1. **Алгоритм Дейкстры** (`CampusMap.findShortestPath`):
    - **Вход**: Идентификаторы начальной и конечной вершин.
    - **Выход**: Список вершин, представляющих кратчайший путь.
    - **Шаги**:
        1. Инициализация: Установить расстояние до начальной вершины равным 0, до остальных — бесконечности.
        2. Использовать приоритетную очередь для выбора вершины с минимальным текущим расстоянием.
        3. Для каждой соседней вершины обновить расстояние, если найден более короткий путь.
        4. Сохранять предыдущие вершины для восстановления пути.
        5. По завершении восстановить путь от конечной вершины к начальной.
    - **Сложность**: O((V + E) log V), где V — число вершин, E — число ребер.

2. **Обновление весов ребер** (`CampusMap.updateEdgeWeights`):
    - Ребра сортируются по длине, и каждому ребру присваивается вес, равный его индексу в отсортированном списке.
    - **Сложность**: O(E log E) из-за сортировки.

3. **Обработка событий мыши** (`MapPanel`):
    - Определение ближайшей вершины, ребра или сегмента полигона с помощью вычисления расстояний.
    - Поддержка рисования (перетаскивание для создания формы) и редактирования (перемещение вершин полигона).
    - **Сложность**: O(V) для поиска вершины, O(E) для поиска ребра, O(N) для поиска сегмента полигона, где N — число точек полигона.



## Инструкция по сборке и запуску
### Требования
- **Java**: JDK 24 или выше.
- **Maven**: Версия 3.6.0 или выше.
- **Среда разработки**: IntelliJ IDEA, Eclipse или аналогичная (опционально).

### Структура проекта
Проект организован в соответствии со стандартной структурой Maven:
```
    Navigation/
    ├── pom.xml
    ├── src/
    │   ├── main/
    │   │   ├── java/
    │   │   │   ├── model/
    │   │   │   │   ├── CampusMap.java
    │   │   │   │   ├── Edge.java
    │   │   │   │   ├── Node.java
    │   │   │   ├── ui/
    │   │   │   │   ├── MapPanel.java
    │   │   │   │   ├── Navigation.java
    │   │   │   │   ├── RoundBorder.java
    │   │   │   ├── util/
    │   │   │   │   ├── FileUtil.java
    |   |   |   ├── Main.java
    │   ├── test/
    │   │   ├── java/
   ```


### Сборка
1. Склонируйте репозиторий или скопируйте файлы проекта в локальную директорию:
   ```bash
   git clone https://github.com/Zor9339/Navigation.git
   ```
2. Перейдите в корневую директорию проекта:
   ```bash
   cd Navigation
   ```
3. Перейдите в Main.java и задайте свою директорию файлов карт (если вы зададите несуществующую директория, будет создана директория maps в корне проекта):
   ```java
   String mapDirectoryPath = <путь_до_вашей_директории>;
   ```
3. Выполните сборку проекта с помощью Maven:
   ```bash
   mvn clean install
   ```
   Это скомпилирует проект, загрузит зависимости и создаст исполняемый JAR-файл в директории `target`.

### Запуск
1.  Запустите созданный JAR-файл:
   ```bash
   java -jar target\Navigation-1.0-SNAPSHOT.jar
   ```
---
>  Если вы работаете не через консоль, а в IDE, импортируйте проект как Maven-проект и запустите класс `Main`. Если вы хотите получить jar файл, то выполните Build -> Build Artifacts. Jar файл будет в out/artifacts/Navigation_jar 
---

### Использование
1. **Режим редактирования**:
    - Нажмите кнопку «Edit Mode».
    - **Добавление здания**:
        - Нажмите «Add Building», введите имя, выберите форму (прямоугольник или окружность).
        - Перетащите мышь для создания формы, затем отредактируйте вершины (если нужно).
        - Нажмите «Finish Drawing» и выберите точку входа на контуре здания.
    - **Добавление дороги**:
        - Нажмите «Add Road», выберите начальную точку (здание или перекресток).
        - Кликните для добавления промежуточных точек, дважды кликните для завершения.
    - **Удаление**: Выберите здание, перекресток или дорогу и нажмите «Delete».
    - **Сохранение/загрузка**: Используйте кнопки «Save» и «Open» для работы с файлами `.map`.

2. **Режим навигации**:
    - Выберите начальное и конечное здание из выпадающих списков.
    - Нажмите «Find Shortest Path» для отображения маршрута.
    - Путь будет показан синими линиями на карте.

3. **Масштабирование и перемещение**:
    - Используйте колесо мыши для масштабирования.
    - Нажмите «1:1» для сброса масштаба.

### Пример использования
**Сценарий**: Создание карты кампуса университета.
1. Запустите приложение, переключитесь в режим редактирования.
2. Добавьте здания «Столовая» (прямоугольник) и «Библиотека» (окружность).
3. Соедините их дорогой через перекресток.
4. Сохраните карту как `campus.map`.
5. Переключитесь в режим навигации, выберите «Столовая» как начальную точку и «Библиотека» как конечную.
6. Нажмите «Find Shortest Path». Путь отобразится на карте.

**Результат**: Путь от библиотеки до столовой, проходящий через перекресток, будет показан синими линиями.

## Примеры реального применения
1. **Университетские кампусы**: Система может использоваться для навигации студентов и персонала, показывая кратчайшие пути между корпусами.
2. **Логистика**: Адаптация системы для управления маршрутами доставки внутри складов или логистических центров.


## Ограничения и возможные улучшения
- **Ограничения**:
    - Отсутствует поддержка направленных дорог.
    - Нет учета препятствий или дополнительных факторов (например, время прохода).
- **Улучшения**:
    - Добавить алгоритм A* для более быстрого поиска пути.
    - Внедрить поддержку направленных графов и различных типов дорог.
    - Добавить возможность импорта карт из внешних форматов (например, OpenStreetMap).
